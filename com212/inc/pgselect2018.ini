<?php
/*
pgselect.ini 改良
*/
class PgSelect2018 {
// テーブル開始タグの印字
  function printTableHeader() {
   print("<div id=\"freezingDiv\" style=\"overflow:auto; width:100%;  background-color:#ffcc66\">");//height:500 

   print("<TABLE class=standings cellSpacing=1 cellPadding=1 width=100%><TBODY>");

  }

// 列名の印字
  function printHeader($i, $str) {
   print("<tr>
<td class=standingsHeadPl></td>
<td class=standingsHeadPl colspan=6 >セミナー情報</td>
<td class=standingsHeadPl colspan=3 >担当</td>
<td class=standingsHeadPl colspan=2 >その他</td>
<td class=standingsHeadPl colspan=8 >締切</td>
<td class=standingsHeadPl ></td>
</tr>");
   print("
<tr>
<td nowrap class=standingsHeadPl width=43 ><input type=\"button\" value=\"最新\" style=\"color: #FF0000\" onclick=\"rCheck2();\"></td>
<td nowrap class='standingsHeadPl' width=75>セミナー<br>開催日</td>
<td nowrap class=standingsHeadPl width=235>学会名</td>
<td nowrap class=standingsHeadPl width=44>品目</td>
<td nowrap class=standingsHeadPl width=80>セミナー名</td>
<td nowrap class=standingsHeadPl width=105>会場</td>
<td nowrap class=standingsHeadPl width=44>特記<br>事項</td>

<td nowrap class=standingsHeadPl width=44>製品</td>
<td nowrap class=standingsHeadPl width=44>組織化</td>
<td nowrap class=standingsHeadPl width=44>CL</td>

<td nowrap class=standingsHeadPl width=44>海外<br>演者</td>
<td nowrap class=standingsHeadPl width=44>趣意書<br>入手</td>

<td nowrap class=standingsHeadPl width=44>セミナ<br>申込日</td>
<td nowrap class=standingsHeadPl width=44>役割者<br>決定</td>
<td nowrap class=standingsHeadPl width=44>MR宛<br>mail</td>
<td nowrap class=standingsHeadPl width=44>事前<br>申込</td>
<td nowrap class=standingsHeadPl width=44>抄録</td>
<td nowrap class=standingsHeadPl width=44>ｱﾝｹｰﾄ<br>作成</td>
<td nowrap class=standingsHeadPl width=44>資材<br>発注</td>
<td nowrap class=standingsHeadPl width=44>控室<br>案内</td>

<td nowrap class=standingsHeadPl width=44>分担表</td></tr>"
   );
  }


// アップロード済みファイルへのリンク作成
function makeLink($sys_name=null,$org_name=null) {
  if (empty($sys_name)) return;
  $sys_name=urlencode($sys_name); // 2012.4.20追加
  $finfo = "<a href=\"./adm_down2012.php?fname=" . $sys_name . "\" target=_blank>";
  if (strtolower(substr($org_name,-3)) == 'pdf') {
    $finfo .= "<img src=\"../images/pdf.png\" title=\"". $org_name . "\" width=22></a>";
  } else if (strtolower(substr($org_name,-3)) == 'doc') {
    $finfo .= "<img src=\"../images/word.gif\" title=\"". $org_name . "\" width=22></a>";
  } else if (strtolower(substr($org_name,-4)) == 'docx') {
    $finfo .= "<img src=\"../images/word.gif\" title=\"". $org_name . "\" width=22></a>";
  } else if (strtolower(substr($org_name,-3)) == 'xls') {
    $finfo .= "<img src=\"../images/excel.png\" title=\"". $org_name . "\" width=21></a>";
  } else if (strtolower(substr($org_name,-4)) == 'xlsx') {
    $finfo .= "<img src=\"../images/excel.png\" title=\"". $org_name . "\" width=21></a>";
  } else {
    $finfo .= "<img src=\"../images/mail.png\" title=\"". $org_name . "\" width=18></a>";
  }
     return($finfo);
}



// データ印字
  function printDataRow($arr,$cc,$upfile) {

  $ColumnNumber = Array(
	'学会名'=>'4',
	'セミナー名'=>'5',
	'セミナー開催日'=>'9',
	'会場'=>'13',
	'薬剤責任者'=>'15',
	'品目'=>'34',
	'CL窓口'=>'35',
	'MR宛mail'=>'38',
	'趣意書入手'=>'39',
	'事前申込'=>'47',
	'抄録進捗'=>'48',
	'抄録有無'=>'100',
	'控室案内'=>'51',
	'役割者決定'=>'98',
	'役割分担表'=>'65',
	'特記事項'=>'92',
	'組織化担当'=>'93',
	'海外演者'=>'94',
	'役割者決定予定日'=>'97',
	'アンケート作成'=>'103',
	'資材発注実施'=>'104',
	'控室案内予定日'=>'105',
	'セミナー申込日'=>'96',
	'MR宛mail予定日'=>'99',
	'アンケート作成予定日'=>'106',
);


// ポップアップ
	$ppstr = "会期 : " . $arr[12] . "<br>開催時間 : " . $arr[10];
// リンク
	if (!empty($arr[74])) $arr[$ColumnNumber['学会名']] = "<a href=$arr[74] target=_blank>" . $arr[$ColumnNumber['学会名']] . "</a>";
	if (!empty($arr[$ColumnNumber['特記事項']])) {
		$oid = $arr[0];
		$arr[$ColumnNumber['特記事項']] = "<a href=\"javascript:void(0)\" onclick=\"TopWindow('" . $arr[0] . "',0,1);\">有</a></td>";
	}
	if (!empty($arr[$ColumnNumber['抄録進捗']])) {
		$oid = $arr[0];
		$arr[$ColumnNumber['抄録進捗']] = "<a href=\"javascript:void(0)\" onclick=\"TopWindow('" . $arr[0] . "',0,2);\">" . $arr[$ColumnNumber['抄録進捗']] . "</a></td>";
	}

// ファイル
	// チラシ
	if (!empty($upfile[0]['org_filename'])) {
		$finfo=$this->makeLink($upfile[0]['sys_filename'],$upfile[0]['org_filename']);
		$arr[$ColumnNumber['セミナー名']] = $finfo . $arr[$ColumnNumber['セミナー名']] ;
	}
	// 趣意書
	if (!empty($upfile[5]['org_filename'])) {
		$finfo=$this->makeLink($upfile[5]['sys_filename'],$upfile[5]['org_filename']);
		$arr[$ColumnNumber['趣意書']] .= $finfo;
	}
	// アンケート
	if (!empty($upfile[6]['org_filename'])) {
		$finfo=$this->makeLink($upfile[6]['sys_filename'],$upfile[6]['org_filename']);
		$enquate_sakusei = $finfo;
	}
	// 役割分担表
	if (!empty($upfile[7]['org_filename'])) {
		$finfo=$this->makeLink($upfile[7]['sys_filename'],$upfile[7]['org_filename']);
		$yakuwari_bunntan = $finfo;
	}
	// MR宛てメール
	if (!empty($upfile[8]['org_filename'])) {
		$finfo=$this->makeLink($upfile[8]['sys_filename'],$upfile[8]['org_filename']);
		$mrate_mail = $finfo;
	}

// 済
	if (!empty($arr[93])) {
		$arr[$ColumnNumber['資材発注実施']] .= "済";
	}

// 文字数
	$mojisu = mb_strlen($arr[13],"UTF-8");
	if ($mojisu > 32) {
		$ppstr = $arr[$ColumnNumber['会場']];
		$string_cut = mb_substr($arr[$ColumnNumber['会場']],0,32,'UTF-8') . "...";
		$arr[$ColumnNumber['会場']] = "<div onMouseover=\"poptext='" .$ppstr . "';popvisible=1;\" onMouseOut=\"popvisible=0;\">".htmlspecialchars($string_cut)."</div>";
	}


// 上段

   print("
<td nowrap class='standingsWinCenter' width=75 rowspan=2 >
<div onMouseover=\"poptext='" .$ppstr . "';popvisible=1;\" onMouseOut=\"popvisible=0;\">
" . htmlspecialchars($arr[$ColumnNumber['セミナー開催日']]) . "</div></td>
<td nowrap class=standingsWin2018 width=235 rowspan=2 >" . $arr[$ColumnNumber['学会名']] . "</td>
<td nowrap class=standingsWinCenter width=44 rowspan=2 >" . $arr[$ColumnNumber['品目']] . "</td>
<td nowrap class=standingsWin2018       width=80 rowspan=2 >" . $arr[$ColumnNumber['セミナー名']] . "</td>
<td nowrap class=standingsWin2018       width=105 rowspan=2>" . $arr[$ColumnNumber['会場']] . "</td>
<td nowrap class=standingsWinCenter width=44 rowspan=2>" . $arr[$ColumnNumber['特記事項']] . "</td>

<td nowrap class=standingsWin2018 width=44 >" . $arr[$ColumnNumber['薬剤責任者']] . "</td>
<td nowrap class=standingsWin2018 width=44 >" . $arr[$ColumnNumber['組織化担当']] . "</td>
<td nowrap class=standingsWin2018 width=44 >" . $arr[$ColumnNumber['CL窓口']] . "</td>
<td nowrap class=standingsWinCenter width=44>". $arr[$ColumnNumber['海外演者']] . "</td>
<td nowrap class=standingsWinCenter width=44>" .$arr[$ColumnNumber['趣意書']] . "</td>
<td nowrap class=standingsWin2018 width=44>-</td>
<td nowrap class=standingsWin2018 width=44>". substr($arr[$ColumnNumber['役割者決定予定日']] ,3) . "</td>
<td nowrap class=standingsWin2018 width=44>". substr($arr[$ColumnNumber['MR宛mail予定日']] ,3) . "</td>
<td nowrap class=standingsWin2018 width=44>-</td>
<td class=standingsWinMini width=44 rowspan=2>" . $arr[$ColumnNumber['抄録進捗']] . "</td>
<td nowrap class=standingsWin2018 width=44>" . substr($arr[$ColumnNumber['アンケート作成予定日']] ,3) . "</td>
<td nowrap class=standingsWin2018 width=44>-</td>
<td nowrap class=standingsWin2018 width=44>". substr($arr[$ColumnNumber['控室案内予定日']] ,3) . "</td>
<td nowrap class=standingsWinCenter width=44>" . $yakuwari_bunntan . "</td></tr>

<tr bgcolor=" .$cc . ">
<td nowrap class=standingsWin2018 width=44>-</td>
<td nowrap class=standingsWin2018 width=44>-</td>
<td nowrap class=standingsWin2018 width=44>-</td>
<td nowrap class=standingsWin2018 width=44>-</td>
<td nowrap class=standingsWin2018 width=44>". substr($arr[$ColumnNumber['趣意書入手']] ,3) . "</td>
<td nowrap class=standingsWin2018 width=44>". substr($arr[$ColumnNumber['セミナー申込日']] ,3) . "</td>
<td nowrap class=standingsWin2018 width=44>". substr($arr[$ColumnNumber['役割者決定']] ,3) . "</td>
<td nowrap class=standingsWin2018 width=44>". substr($arr[$ColumnNumber['MR宛mail']] ,3) . $mrate_mail . "</td>
<td nowrap class=standingsWin2018 width=44>". substr($arr[$ColumnNumber['事前申込']] ,3) . "</td>
<td nowrap class=standingsWin2018 width=44>". substr($arr[$ColumnNumber['アンケート作成']] ,3) . $enquate_sakusei . "</td>
<td nowrap class=standingsWin2018 width=44>". substr($arr[$ColumnNumber['資材発注実施']],3) . "</td>
<td nowrap class=standingsWin2018 width=44>". substr($arr[$ColumnNumber['控室案内']],3) . "</td>
<td nowrap class=standingsWin2018 width=44>". substr($arr[$ColumnNumber['役割分担表']],3) . "</td>"
   );
  }

}
?>
